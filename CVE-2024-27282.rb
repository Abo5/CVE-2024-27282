def check_ruby_version_for_vulnerability
  # Get the installed Ruby version
  ruby_version = RUBY_VERSION
  puts "Installed Ruby version: #{ruby_version}"

  # Define the vulnerable versions
  vulnerable_versions = [
    { major: 3, minor: 0, patch: 6 },
    { major: 3, minor: 1, patch: 4 },
    { major: 3, minor: 2, patch: 3 },
    { major: 3, minor: 3, patch: 0 }
  ]

  # Parse the installed Ruby version
  installed_version_parts = ruby_version.split('.').map(&:to_i)
  installed_version = {
    major: installed_version_parts[0],
    minor: installed_version_parts[1],
    patch: installed_version_parts[2]
  }

  # Check if the installed version is vulnerable
  is_vulnerable = vulnerable_versions.any? do |v|
    installed_version[:major] == v[:major] &&
    installed_version[:minor] <= v[:minor] &&
    installed_version[:patch] <= v[:patch]
  end

  if is_vulnerable
    puts "Warning: Your Ruby version is vulnerable to CVE-2024-27282. Please update to a secure version."
  else
    puts "Your Ruby version is not vulnerable to CVE-2024-27282."
  end
end

check_ruby_version_for_vulnerability
